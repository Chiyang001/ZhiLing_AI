# AI桌面助手 🤖

基于Ollama的本地AI对话助手，支持与本地AI模型对话并执行各种桌面任务。

## 功能特性 ✨

### 🎯 智能对话
- 支持多轮上下文对话，AI会记住之前的对话内容
- 基于本地Ollama模型，保护隐私安全
- 支持流式输出，实时显示AI回复
- 提供标准模式和快速模式两种启动选项

### 🚀 应用程序管理
- **智能应用启动**: 支持模糊匹配，可通过应用名称快速打开程序
- **系统工具访问**: 快速启动记事本、计算器、任务管理器等系统工具
- **桌面快捷方式管理**: 自动扫描桌面和开始菜单的快捷方式
- **应用程序搜索**: 搜索系统中已安装的应用程序

### 📁 文件系统操作
- **文件管理**: 新建、删除、重命名、复制、剪切文件和文件夹
- **批量操作**: 支持一次执行多个文件操作任务
- **智能文件匹配**: 模糊匹配文件名，提高操作成功率
- **内容写入**: 将AI生成的内容写入txt、md等文本文件
- **目录浏览**: 列出指定目录的文件和文件夹

### ⚙️ 系统控制
- **电源管理**: 关机、重启、注销、休眠、睡眠、锁定
- **网络控制**: WiFi开关控制
- **音量调节**: 系统音量调节和静音控制
- **系统工具**: 启动设备管理器、服务管理器、注册表编辑器等
- **系统信息**: 获取详细的系统配置信息

### 🧹 系统维护
- **垃圾清理**: 清理临时文件、浏览器缓存、回收站等
- **磁盘管理**: 启动磁盘清理和管理工具
- **性能监控**: 启动性能监视器和资源监视器

## 安装要求 📋

### 系统要求
- **操作系统**: Windows 10/11 (主要支持)
- **Python版本**: Python 3.7+ (推荐Python 3.8+)
- **内存**: 至少4GB可用内存（推荐8GB+）
- **存储**: 至少2GB可用空间（用于AI模型）
- **网络**: 首次下载AI模型需要网络连接

### Python版本兼容性
- ✅ Python 3.8+ (完全支持，推荐)
- ✅ Python 3.7 (支持，需要额外的typing-extensions包)
- ❌ Python 3.6及以下 (不支持)

### 依赖安装
```bash
# 安装Python依赖
pip install -r requirements.txt

# 或者手动安装主要依赖：
pip install requests>=2.28.0 psutil>=5.9.0

# 主要依赖包括：
# - requests: HTTP请求库，用于与Ollama API通信
# - psutil: 系统信息获取库，用于获取CPU、内存等系统信息
# - typing-extensions: 类型提示支持 (Python < 3.8需要)
```

### 可选依赖
为了获得更好的性能和额外功能，你可以安装以下可选依赖：
```bash
# 更快的JSON处理
pip install orjson>=3.8.0

# 更快的HTTP客户端
pip install httpx>=0.24.0

# 系统通知支持
pip install plyer>=2.1.0

# 配置文件处理
pip install pyyaml>=6.0

# 彩色日志输出
pip install colorlog>=6.7.0
```
# AI桌面助手 🤖

基于Ollama的本地AI对话助手，支持与本地AI模型对话并执行各种桌面任务。

## 功能特性 ✨

### 🎯 智能对话
- 支持多轮上下文对话，AI会记住之前的对话内容
- 基于本地Ollama模型，保护隐私安全
- 支持流式输出，实时显示AI回复
- 提供标准模式和快速模式两种启动选项

### 🚀 应用程序管理
- **智能应用启动**: 支持模糊匹配，可通过应用名称快速打开程序
- **系统工具访问**: 快速启动记事本、计算器、任务管理器等系统工具
- **桌面快捷方式管理**: 自动扫描桌面和开始菜单的快捷方式
- **应用程序搜索**: 搜索系统中已安装的应用程序

### 📁 文件系统操作
- **文件管理**: 新建、删除、重命名、复制、剪切文件和文件夹
- **批量操作**: 支持一次执行多个文件操作任务
- **智能文件匹配**: 模糊匹配文件名，提高操作成功率
- **内容写入**: 将AI生成的内容写入txt、md等文本文件
- **目录浏览**: 列出指定目录的文件和文件夹

### ⚙️ 系统控制
- **电源管理**: 关机、重启、注销、休眠、睡眠、锁定
- **网络控制**: WiFi开关控制
- **音量调节**: 系统音量调节和静音控制
- **系统工具**: 启动设备管理器、服务管理器、注册表编辑器等
- **系统信息**: 获取详细的系统配置信息

### 🧹 系统维护
- **垃圾清理**: 清理临时文件、浏览器缓存、回收站等
- **磁盘管理**: 启动磁盘清理和管理工具
- **性能监控**: 启动性能监视器和资源监视器

## 安装要求 📋

### 系统要求
- Windows 10/11 (主要支持)
- Python 3.7+
- 至少4GB可用内存（推荐8GB+）


### Ollama安装
1. 从 [Ollama官网](https://ollama.ai) 下载并安装Ollama
2. 安装至少一个AI模型，例如：
```bash
# 推荐的轻量级模型
ollama pull gemma:2b          # 约1.5GB，快速启动
ollama pull phi3:mini         # 约2GB，平衡性能
ollama pull qwen2:7b          # 约4GB，更强能力
ollama pull llama3:8b         # 约4.5GB，综合表现好

# 代码专用模型
ollama pull codellama:7b      # 代码生成和理解
```

## 快速开始 🚀

### 完整安装步骤

1. **检查Python版本**
```bash
python --version
# 确保版本为 3.7 或更高
```

2. **克隆或下载项目**
```bash
# 如果使用Git
git clone <repository-url>
cd ai-desktop-assistant

# 或者直接下载项目文件到本地文件夹
```

3. **安装Python依赖**
```bash
# 安装必需依赖
pip install -r requirements.txt

# 或者使用国内镜像加速安装
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

4. **安装和配置Ollama**
```bash
# 下载并安装Ollama (访问 https://ollama.ai)
# 安装完成后，下载推荐的AI模型：

# 轻量级模型 (适合4GB内存)
ollama pull gemma:2b

# 平衡性能模型 (适合8GB内存)
ollama pull llama3:8b

# 高性能模型 (适合16GB+内存)
ollama pull llama3:70b
```

5. **启动程序**
```bash
python ai_desktop_assistant.py
```

### 快速启动
```bash
# 直接启动 (会自动检测可用模型)
python ai_desktop_assistant.py

# 使用快速模式启动
python ai_desktop_assistant.py --quick
```

### 启动模式选择
程序提供两种启动模式：

1. **标准模式** (推荐)
   - 完整功能，详细任务识别
   - 初始化时间较长（约60-90秒）
   - 适合日常使用

2. **快速模式**
   - 简化提示词，快速启动
   - 初始化时间较短（约20-40秒）
   - 适合快速任务处理

### 模型选择
程序会自动检测已安装的Ollama模型，并显示：
- 模型大小估算
- 预估初始化时间
- 系统配置适配建议

## 使用示例 💡

### 应用程序操作
```
👤 你: 打开记事本
🤖 AI助手: 好的，我来帮你打开记事本。
✅ 已打开应用: 记事本

👤 你: 启动任务管理器
🤖 AI助手: 好的，我来帮你启动任务管理器。
✅ 任务管理器已启动
```

### 文件操作
```
👤 你: 在桌面创建一个名为"项目文档"的文件夹
🤖 AI助手: 好的，我来帮你在桌面创建一个名为"项目文档"的文件夹。
✅ 任务1: 已创建文件夹: 项目文档

👤 你: 将这份报告写入到桌面的report.txt文件中
🤖 AI助手: 好的，我来帮你将报告内容写入到桌面的report.txt文件中。
✅ 内容已成功写入文件: report.txt
```

### 系统控制
```
👤 你: 把音量调到50%
🤖 AI助手: 好的，我来帮你把系统音量调节到50%。
✅ 系统音量已设置为 50%

👤 你: 清理系统垃圾
🤖 AI助手: 好的，我来帮你清理系统垃圾和缓存文件。
🎯 清理完成! 总共释放了约 1.2 GB 的磁盘空间
```

### 批量操作
```
👤 你: 在桌面创建5个文件夹，从1到5命名，再在其中分别创建一个text.txt文件
🤖 AI助手: 好的，我来帮你在桌面创建5个文件夹（1到5），并在每个文件夹中创建text.txt文件。
📊 批量操作完成: 成功 10/10 个任务
```

## 支持的任务类型 📝

### 应用程序相关
- `打开[应用名]` - 启动应用程序
- `搜索应用 [关键词]` - 搜索已安装的应用
- `列出桌面快捷方式` - 显示桌面所有项目

### 文件操作相关
- `新建文件/文件夹` - 创建文件或文件夹
- `删除 [路径]` - 删除文件或文件夹
- `重命名 [原名] 为 [新名]` - 重命名文件
- `复制 [源路径] 到 [目标路径]` - 复制文件
- `写入内容到文件` - 将文本写入文件

### 系统控制相关
- `关机/重启/注销/休眠/睡眠/锁定` - 电源管理
- `调节音量到 [数值]` - 音量控制
- `开启/关闭WiFi` - 网络控制
- `清理系统垃圾` - 系统清理

### 信息查询相关
- `系统信息` - 显示系统配置
- `列出目录 [路径]` - 显示目录内容

## 特殊命令 🔧

- `clear` / `清空` - 清空对话历史
- `history` / `历史` - 查看对话摘要
- `quit` / `exit` / `退出` - 退出程序

## 配置文件 ⚙️

程序支持通过`config.json`进行配置：

```json
{
    "ollama_base_url": "http://localhost:11434",
    "default_model": "llama3:8b",
    "max_history_length": 20,
    "quick_mode": false,
    "auto_confirm_safe_operations": false
}
```

## 性能优化建议 🔧

### 硬件要求
- **CPU**: 4核心以上推荐
- **内存**: 8GB以上推荐（4GB最低）
- **存储**: SSD推荐，提升模型加载速度

### 模型选择建议
- **低配置系统**: gemma:2b, phi3:mini
- **中等配置**: qwen2:7b, llama3:8b
- **高配置系统**: llama3:70b, qwen2:72b

### 启动速度优化
- 使用快速模式可减少50%的初始化时间
- SSD存储可显著提升模型加载速度
- 关闭不必要的后台程序释放内存

## 安全说明 🔒

### 数据隐私
- 所有对话数据仅在本地处理，不会上传到云端
- 使用本地Ollama模型，确保数据安全
- 对话历史仅保存在内存中，程序关闭后自动清除

### 操作安全
- 危险操作（如删除文件、系统关机）需要用户确认
- 批量操作会显示详细的操作列表供用户审核
- 系统控制操作具有安全检查机制

## 故障排除 🔧

### 常见问题

**Q: 无法连接到Ollama服务**
A: 确保Ollama正在运行，检查端口11434是否被占用

**Q: 模型初始化时间过长**
A: 尝试使用快速模式或选择更小的模型

**Q: 应用程序无法打开**
A: 检查应用是否已安装，尝试使用完整的应用程序名称

**Q: 文件操作失败**
A: 确认文件路径正确，检查是否有足够的权限

### 日志和调试
程序运行时会显示详细的操作结果，包括：
- 任务执行状态
- 错误信息和建议
- 系统资源使用情况

## 更新日志 📅

### v1.0.0
- 初始版本发布
- 支持基本的AI对话和任务执行
- 实现应用程序启动和文件操作功能
- 添加系统控制和维护功能

## 贡献指南 🤝

欢迎提交Issue和Pull Request来改进这个项目！

### 开发环境设置
```bash
git clone <repository-url>
cd ai-desktop-assistant
pip install -r requirements.txt
```

### 代码结构
- `OllamaClient`: Ollama API客户端
- `TaskExecutor`: 任务执行器
- `AIDesktopAssistant`: 主要的助手类

## 许可证 📄

本项目采用MIT许可证，详见LICENSE文件。

## 联系方式 📧

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**享受与AI助手的智能交互体验！** 🎉